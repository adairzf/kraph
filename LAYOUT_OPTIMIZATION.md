# 布局优化说明

## 🎨 优化内容

### 1. **左侧记忆列表可收起**
- ✅ 添加了收起/展开按钮（左上角）
- ✅ 收起后只占40px宽度
- ✅ 带平滑过渡动画
- ✅ 图标提示：← 收起 / → 展开

### 2. **知识图谱区域大幅扩大**
- ✅ 右侧边栏宽度：从320px扩大到50%（最大800px）
- ✅ 图谱高度：占据右侧主要空间（约60%）
- ✅ 角色档案：固定在下方（最多40%高度）
- ✅ 图谱可滚动溢出的角色档案内容

### 3. **图谱视觉优化**
- ✅ 节点大小：28 → 35
- ✅ 字体大小：增加到12px
- ✅ 斥力：200 → 300（节点更分散）
- ✅ 边长：80 → 120（关系更清晰）
- ✅ 边的箭头：显示方向
- ✅ 边的标签：显示关系类型

## 📐 布局结构

```
┌─────────────────────────────────────────────────────────┐
│  Header（标题栏 + 模型指示器 + 操作按钮）                │
├──────┬────────────────────────┬─────────────────────────┤
│ 记忆 │      中间面板           │      知识图谱区域        │
│ 列表 │  (问答/编辑/设置)       │      （大幅扩大）        │
│ 可收 │                        │                         │
│ 起   │                        │   ┌─────────────────┐  │
│ ←→  │                        │   │   知识图谱       │  │
│      │                        │   │   (60%高度)     │  │
│260px │                        │   │                 │  │
│ →    │                        │   └─────────────────┘  │
│40px  │                        │   ┌─────────────────┐  │
│      │                        │   │   角色档案       │  │
│      │                        │   │   (40%高度)     │  │
│      │                        │   └─────────────────┘  │
│      │                        │   50% (max 800px)      │
└──────┴────────────────────────┴─────────────────────────┘
```

## 🎯 使用场景

### 场景1：浏览图谱（推荐）
1. **收起左侧记忆列表**（点击 ← 按钮）
2. 中间面板 + 右侧图谱获得更多空间
3. 专注于查看和探索知识图谱

### 场景2：编辑记忆
1. **展开左侧记忆列表**（点击 → 按钮）
2. 从列表选择要编辑的记忆
3. 在中间"编辑"面板修改

### 场景3：添加记忆
1. 左侧可收可展
2. 在中间"问答"面板输入新记忆
3. 右侧实时看到图谱更新

## 💡 交互优化

### 图谱交互
- **缩放**：鼠标滚轮
- **拖动**：按住左键移动
- **节点拖动**：拖动单个节点调整位置
- **点击节点**：查看角色档案
- **悬停**：显示节点/关系详情

### 布局响应
- **左侧收起**：0.3s 平滑动画
- **右侧自适应**：最大800px，占50%宽度
- **图谱自动调整**：响应窗口大小变化

## 🔧 技术细节

### CSS Transitions
```css
.sidebar {
  transition: flex-basis 0.3s ease, padding 0.3s ease;
}
.center {
  transition: margin-left 0.3s ease;
}
```

### Flex布局
```css
/* 右侧边栏 */
.sidebar.right {
  flex: 0 0 50%;
  max-width: 800px;
}

/* 图谱容器 */
.graph-container {
  flex: 1;          /* 占据主要空间 */
  min-height: 0;    /* 允许溢出 */
}

/* 角色档案 */
.character-card-container {
  flex-shrink: 0;      /* 不缩小 */
  max-height: 40%;     /* 最多40% */
  overflow-y: auto;    /* 溢出滚动 */
}
```

## 📊 尺寸对比

| 区域 | 优化前 | 优化后 | 提升 |
|------|--------|--------|------|
| 左侧记忆列表 | 260px | 40px（收起）/ 260px（展开） | 可节省220px |
| 右侧图谱区域 | 320px | 50%（约400-800px） | 提升25%-150% |
| 图谱高度 | 平分 | 60% | 提升20% |
| 节点大小 | 28 | 35 | 提升25% |
| 节点间距 | 80 | 120 | 提升50% |

## ✨ 视觉改进

### Before（优化前）
- 图谱区域：320px x 50%高度 ≈ 160px²
- 节点拥挤，关系线交叉
- 文字较小，不易阅读

### After（优化后）
- 图谱区域：800px x 60%高度 ≈ 480px²
- 节点分散，布局清晰
- 文字更大，关系带箭头
- 边标签显示关系类型

## 🚀 性能优化

### ECharts配置
```javascript
force: {
  repulsion: 300,    // 增加斥力，避免重叠
  edgeLength: 120,   // 增加边长，关系更清晰
  gravity: 0.1,      // 轻微重力，保持聚合
}
```

### 响应式
- `autoresize` 自动响应容器大小变化
- `roam: true` 启用缩放和平移
- `min-height: 300px` 确保最小可用空间

## 📱 响应式建议

### 大屏幕（>1600px）
- 左侧：建议收起
- 中间：自动占据更多空间
- 右侧：达到最大800px

### 中等屏幕（1200-1600px）
- 左侧：按需收起/展开
- 右侧：约占50%

### 小屏幕（<1200px）
- 建议收起左侧以获得更多空间
- 考虑隐藏中间面板或使用标签切换

## 🎨 未来优化方向

1. **右侧也可收起**
   - 添加角色档案收起功能
   - 让图谱占据100%高度

2. **拖拽调整分栏宽度**
   - 添加分隔条拖拽功能
   - 记住用户偏好设置

3. **全屏模式**
   - F11 进入图谱全屏模式
   - 隐藏其他所有面板

4. **自定义布局**
   - 保存用户的布局偏好
   - 预设多种布局模式

---

**更新日期**: 2026-02-15
**版本**: v2.1.0
